"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[63666],{3666:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var i=r(9568),s=r(4049),a=r(6471);class o extends i.Z{static #e=this.options={redirectSelector:'[name="redirectTo"]',redirectParamSelector:'[data-redirect-parameters="true"]',redirectTo:"frontend.cart.offcanvas"};init(){if(this._getForm(),!this._form)throw Error(`No form found for the plugin: ${this.constructor.name}`);this._prepareFormRedirect(),this._registerEvents()}_prepareFormRedirect(){try{let e=s.Z.querySelector(this._form,this.options.redirectSelector),t=s.Z.querySelector(this._form,this.options.redirectParamSelector);e.value=this.options.redirectTo,t.disabled=!0}catch(e){}}_getForm(){this.el&&"FORM"===this.el.nodeName?this._form=this.el:this._form=this.el.closest("form")}_registerEvents(){this.el.addEventListener("submit",this._formSubmit.bind(this))}_formSubmit(e){e.preventDefault();let t=s.Z.getAttribute(this._form,"action"),r=a.Z.serialize(this._form);this.$emitter.publish("beforeFormSubmit",r),this._openOffCanvasCarts(t,r)}_openOffCanvasCarts(e,t){window.PluginManager.getPluginInstances("OffCanvasCart").forEach(r=>this._openOffCanvasCart(r,e,t))}_openOffCanvasCart(e,t,r){e.openOffCanvas(t,r,()=>{this.$emitter.publish("openOffCanvasCart")})}}},6471:(e,t,r)=>{r.d(t,{Z:()=>i});class i{static serialize(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if("FORM"!==e.nodeName){if(t)throw Error("The passed element is not a form!");return{}}return new FormData(e)}static serializeJson(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=i.serialize(e,t);if(!(r instanceof FormData)&&0===Object.keys(r).length||r instanceof FormData&&0===Array.from(r.entries()).length)return{};let s={};for(let[e,t]of r.entries())s[e]=t;return s}}}}]);